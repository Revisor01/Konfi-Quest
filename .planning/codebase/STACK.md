# Technology Stack

**Analysis Date:** 2026-02-27

## Languages

**Primary:**
- **JavaScript** - Backend API (Node.js/Express)
- **TypeScript** 5.1.6 - Frontend React application
- **SQL** - PostgreSQL database queries

**Secondary:**
- **JSX/TSX** - React component syntax
- **HTML/CSS** - Generated by Ionic React framework

## Runtime

**Environment:**
- **Node.js** 18 (specified in `backend/Dockerfile`, requirement `>=16.0.0`)
- **Docker** - Full containerization (frontend, backend, PostgreSQL)

**Package Manager:**
- **npm** (Node Package Manager)
- Lockfile: `package-lock.json` present

## Frameworks

**Core:**
- **React** 19.0.0 - Frontend UI framework (latest stable)
  - `react-router-dom` 5.3.4 - Client-side routing
  - `@ionic/react` 8.5.0 - Cross-platform mobile UI components
  - `@ionic/react-router` 8.5.0 - Ionic routing integration

- **Express** 4.18.2 - Backend REST API framework
  - Runs on port 5000 (Docker: 8623, proxied via Apache)

**Mobile/Desktop:**
- **Capacitor** 7.x - Native app wrapper (iOS, Android)
  - `@capacitor/core` 7.4.2
  - `@capacitor/ios` 7.4.2
  - `@capacitor/android` 7.4.4
  - Plugins: Camera, Filesystem, Push Notifications, Share, Badge, File Opener, Photo Viewer

**Database:**
- **PostgreSQL** 15-alpine - SQL database
  - Connection pool via `pg` 8.16.3 library
  - No ORM used (raw SQL queries)

**Build/Dev:**
- **Vite** 5.2.0 - Frontend bundler (replaces Webpack/Create React App)
  - `@vitejs/plugin-react` 4.0.1 - React JSX support
  - `@vitejs/plugin-legacy` 5.0.0 - Backward compatibility

- **TypeScript** 5.1.6 - Type checking (frontend)
- **Nodemon** 3.0.2 - Dev server auto-reload (backend)

**Testing:**
- **Vitest** 0.34.6 - Unit test runner
  - `@testing-library/react` 16.2.0 - React component testing
  - `@testing-library/dom` 7.21.4 - DOM testing utilities
  - `@testing-library/jest-dom` 5.16.5 - Jest matchers
  - `jsdom` 22.1.0 - DOM environment

- **Cypress** 13.5.0 - E2E testing framework
- **ESLint** 9.20.1 - Linting
  - `typescript-eslint` 8.24.0 - TypeScript support
  - `eslint-plugin-react` 7.32.2 - React rules
  - `eslint-plugin-react-hooks` 5.1.0 - Hooks linting

## Key Dependencies

**Critical - Communication:**
- **socket.io** 4.7.2 (backend) & **socket.io-client** 4.8.1 (frontend) - Real-time messaging/chat
  - WebSocket with polling fallback
  - JWT authentication
  - Room-based event broadcasting

- **axios** 1.10.0 - HTTP client (frontend API requests)
  - Interceptors for token injection
  - 401 auto-logout handling

**Critical - Security & Authentication:**
- **jsonwebtoken** 9.0.2 - JWT token creation/verification
- **bcrypt** 5.1.1 - Password hashing (min 5.1.x for native module)
- **express-rate-limit** 8.2.1 - API rate limiting
  - Auth: 10 requests / 15 minutes (0.67 req/min)
  - File uploads: 30 requests / 15 minutes

**Critical - Email & Notifications:**
- **nodemailer** 6.9.8 - SMTP email sending
  - Host: server.godsapp.de:465 (TLS)
  - Auth: team@konfi-quest.de (env: SMTP_USER, SMTP_PASS)

- **firebase-admin** 12.7.0 - Push notifications & FCM
  - Service account: `backend/push/firebase-service-account.json`
  - APNS (Apple Push) & FCM (Android) support

**Infrastructure:**
- **multer** 1.4.5-lts.1 - File upload handling
  - Chat uploads: 5MB max, encrypted filenames
  - MIME type validation (images, videos, PDFs, office docs, audio)
  - Storage: `/app/uploads/chat/` (Docker mounted)

- **cors** 2.8.5 - Cross-Origin Resource Sharing
  - **Note**: Currently disabled in server.js, Apache handles CORS

- **pg** 8.16.3 - PostgreSQL client library
  - Custom bigint parser (converts to integer)
  - Connection pooling via `new Pool()`

**Optional:**
- **qrcode** 1.5.4 - QR code generation for invite codes
- **@rdlabo/ionic-theme-ios26** 2.2.0 - iOS-style theming
- **@rdlabo/ionic-theme-md3** 1.0.2 - Material Design 3 theming
- **ionicons** 7.4.0 - Icon library
- **terser** 5.4.0 - JavaScript minification

## Configuration

**Environment Variables (Production):**
- `NODE_ENV`: production (backend in Docker)
- `JWT_SECRET`: Key for token signing/verification
- `DATABASE_URL`: PostgreSQL connection string
  - Format: `postgresql://konfi_user:password@postgres:5432/konfi_db`
- `PGHOST`, `PGUSER`, `PGDATABASE`, `PGPASSWORD`, `PGPORT`: PostgreSQL connection
- `SMTP_HOST`: SMTP server (server.godsapp.de)
- `SMTP_PORT`: 465 (TLS)
- `SMTP_USER`: team@konfi-quest.de
- `SMTP_PASS`: Email password
- `CORS_ORIGINS`: Comma-separated allowed origins (default: https://konfi-quest.de, https://www.konfi-quest.de)
- `FIREBASE_SERVICE_ACCOUNT`: Optional JSON-encoded service account (fallback to file)
- `PORT`: Express port (default 5000)

**Frontend Configuration:**
- `API_BASE_URL`: https://konfi-quest.de/api (hardcoded in `src/services/api.ts`)
- `WS_URL`: https://konfi-quest.de (hardcoded in `src/services/websocket.ts`)
- `app.id`: de.godsapp.konfiquest (Capacitor config)

**Build Configuration:**
- `vite.config.ts`: Vite build settings
  - React plugin enabled
  - Vitest globals in test environment
- `tsconfig.json`: TypeScript compiler options
  - Target: ESNext
  - Module: ESNext
  - Strict mode enabled

**Docker Configuration:**
- `docker-compose.yml` at project root orchestrates:
  - PostgreSQL service (port 5432 local-only)
  - Backend service (port 8623 local-only, depends on postgres health)
  - Frontend service (port 8624 local-only)
  - All services restart unless stopped
  - Labels disable Watchtower auto-updates

## Platform Requirements

**Development:**
- Node.js 16+ (18 LTS recommended)
- npm (included with Node.js)
- Docker & Docker Compose (for local PostgreSQL, backend, frontend)
- macOS/Linux recommended (for native module compilation)

**Production:**
- Docker with Docker Compose
- PostgreSQL 15+ database
- Node.js 18 runtime in container
- SMTP server access (server.godsapp.de:465)
- Firebase admin credentials for push notifications
- Apache reverse proxy (with custom vhost config)
- DNS: konfi-quest.de (SSL via Apache, not app)

**Native Mobile:**
- iOS 13+ / iPadOS 13+
- Android 7+ (API 24+)
- Capacitor plugins for permissions handling

---

*Stack analysis: 2026-02-27*
